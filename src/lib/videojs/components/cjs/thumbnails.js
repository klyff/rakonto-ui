"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var videojs=_interopDefault(require("video.js"));const defaults={width:160,height:90,basePath:"",src:""};var thumbTrack,tdiv,istrack=!1;const onPlayerReady=(e,t)=>{function s(e){var t,s,r;if(-1===(s=e.indexOf("#")))return{src:e,w:0,h:0,x:0,y:0};t=e.substring(0,s);if("xywh="!==(r=e.substring(s+1)).substring(0,5))return{src:defaults.basePath+t,w:0,h:0,x:0,y:0};var i=r.substring(5).split(",");return{src:defaults.basePath+t,w:parseInt(i[2]),h:parseInt(i[3]),x:parseInt(i[0]),y:parseInt(i[1])}}defaults.basePath="";""!==t.basePath&&(defaults.basePath=t.basePath);if(t.width&&t.height){defaults.width=t.width;defaults.height=t.height}var r=t;videojs.browser.TOUCH_ENABLED||e.on("medialoaded",function(t){e.sprite=!1;var i;console.log(e.shadowSlide);var a=e.textTracks().length;if(0!==a){l=0;for(;l<a;){if("metadata"===e.textTracks()[l].kind&&e.textTracks()[l].src){thumbTrack=e.textTracks()[l];istrack=!0;var d=thumbTrack&&thumbTrack.cues.length;thumbTrack.mode="hidden";break}l++}if(!0===istrack){if(!((d=thumbTrack&&thumbTrack.cues.length)<1)){for(var l=0;l<d;){s(thumbTrack.cues[l].text);l++}var o=e.controlBar.progressControl,h=(e.el_.querySelector(".vjs-progress-holder"),e.el_.querySelector(".vjs-thumb-tooltip"));null!==h&&h.parentNode.removeChild(h);var n=e.el_.querySelector(".vjs-thumb-image");null!==n&&n.parentNode.removeChild(n);var u=e.el_.querySelector(".vjs-thumbnail-holder");null!==u&&u.parentNode.removeChild(u);var v=e.el_.querySelector(".vjs-thumb-poster");null!==v&&v.parentNode.removeChild(v);(tdiv=document.createElement("div")).className="vjs-thumbnail-holder";var c=document.createElement("div");c.className="vjs-thumb-tooltip";var m=document.createElement("img");tdiv.appendChild(m);m.className="vjs-thumb-image";tdiv.appendChild(c);o.el().appendChild(tdiv);if(e.shadowSlide){var f=document.createElement("div");f.className="vjs-thumb-poster";var p=document.createElement("canvas");f.appendChild(p);e.el_.insertBefore(f,e.el_.querySelector(".vjs-poster"))}e.duration();e.on("durationchange",function(t){e.duration()});e.on("loadedmetadata",function(t){e.duration()});var g=this.el_.querySelector(".vjs-play-progress").querySelector(".vjs-time-tooltip");videojs.dom.addClass(g,"vjs-abs-hidden");var y=o.el().querySelector(".vjs-mouse-display");y.style.opacity=0;o.on("mousemove",b);e.on("progressdown",b);e.on("progressup",j);o.on("mouseout",w)}}else tdiv&&videojs.dom.addClass("tdiv","vjs-hidden")}else tdiv&&videojs.dom.addClass("tdiv","vjs-hidden");function b(t){var a=e.duration(),d=this.el_.querySelector(".vjs-mouse-display"),h=Number(d.style.left.replace(/px$/,"")),n=h/o.el().querySelector(".vjs-progress-holder").offsetWidth*a,u=y.querySelector(".vjs-time-tooltip");c.innerHTML=u.innerHTML;var v=thumbTrack&&thumbTrack.cues.length;l=0;for(var g=!1;l<v;){var b=thumbTrack.cues[l];if(b.startTime<=n&&b.endTime>=n){g=!0;i=s(b.text);break}l++}if(!0===g){tdiv.classList.remove("vjs-thumb-hidden");i.src&&m.src!==i.src&&(m.src=i.src);if(0===i.w){i.w=r.width;m.style.width=i.w+"px"}if(0===i.h){i.h=r.height;m.style.height=i.h+"px"}if(tdiv.style.width!==i.w||tdiv.style.height!==i.h){tdiv.style.width=i.w+"px";tdiv.style.height=i.h+"px"}m.style.left=-i.x+"px";m.style.top=-i.y+"px";var j=i.w,w=j/2,x=o.el().offsetWidth,k=e.el_.querySelector(".vjs-progress-holder").offsetLeft,T=w-k;h+w+k>x?h=x-j:h<T?h=0:h-=T;tdiv.style.left=h+"px";if(videojs.holderdown&&e.shadowSlide){var S=p.getContext("2d");p.width=e.el_.offsetWidth;p.height=e.el_.offsetHeight;f.style.width=p.width+"px";f.style.height=p.height+"px";S.clearRect(0,0,p.width,p.height);S.drawImage(m,i.x,i.y,i.w,i.h,0,0,p.width,p.height)}}else tdiv.classList.add("vjs-thumb-hidden")}function j(t){tdiv.style.left="-1000px";videojs.holderdown=!1;if(e.shadowSlide){f.removeAttribute("style");p.width=0;p.height=0}document.removeEventListener("mouseup",j)}function w(e){1!=videojs.holderdown&&(tdiv.style.left="-1000px")}})},thumbnails=function(e){this.ready(()=>{onPlayerReady(this,videojs.mergeOptions(defaults,e))})},registerPlugin=videojs.registerPlugin||videojs.plugin;registerPlugin("thumbnails",thumbnails);thumbnails.VERSION="1.1";module.exports=thumbnails;